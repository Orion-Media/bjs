Object.prototype.getProperty=function(a){let b=this,c=a.split('.'),d=c.length;for(let i=0;i<d;i++){if(b[c[i]]!==void 0)b=b[c[i]];else return void 0}return b};Object.prototype.setProperty=function(a,b){let c=this,d=a.split('.'),e=d.length;for(let i=0;i<e-1;i++){if(c[d[i]]===void 0){c[d[i]]=isNaN(parseInt(d[i+1],10))?{}:[]}c=c[d[i]]}c[d[e-1]]=b};'use strict';var bjs=selector=>new bjs.Selector(selector);bjs.Model=class Model{constructor(a,b){let c=this;this.proxyHandler={get:(d,e)=>{if(e==='constructor')return{name:'Proxy'};if(d[e]===void 0)return;if(d[e].constructor.name!=='Proxy'&&typeof d[e]=='object'){let f=c.map.get(d);f=(f!==void 0?f+'.':'')+e;c.map.set(d[e],f);d[e]=new Proxy(d[e],c.proxyHandler)}return d[e]},set:(d,e,f,g)=>{let h=d[e];d[e]=f;if(h!==f){let k=c.map.get(d);k=(k!==void 0?k+'.':'')+e;c._apply(k)}}};this.data=new Proxy(b||{},this.proxyHandler);this.map=new WeakMap;this.selector=new bjs.Selector(a);this._init();this._apply()}get(a){return this.data.getProperty(a)}set(a,b){this.data.setProperty(a,b)}_init(){let a;for(let i=0;i<this.selector.length;i++){a=this.selector.get(i);a.addEventListener('change',bjs.Model.eventHander,!0);a.addEventListener('keyup',bjs.Model.eventHander,!0)}}_apply(a,b){let c,d,e;if(b===void 0){c='[data-model-base], [data-model-value'+(a!==void 0?'="'+a+'"':'')+']';d=this.selector.find(c);for(let i=0,f;i<d.length;i++){f=d[i].getAttribute('data-model-base');if(f!==null)e=f+'.';f=d[i].getAttribute('data-model-value');if(f!==null){e+=this.get(f)+'.'}else{f=d[i].getAttribute('data-model-key');if(f!==null)e+=f+'.'}let g=d.find('[data-field]');for(let i=0;i<g.length;i++)g[i].setAttribute('data-model',e+g[i].getAttribute('data-field'));if(a!==void 0)this._apply(e,1)}}c='[data-model'+(a!==void 0?'^="'+a+'"':'')+']';d=this.selector.find(c);for(let i=0;i<d.length;i++){e=this.data.getProperty(d[i].getAttribute('data-model'));if(e===void 0)e='';if(d[i]instanceof HTMLInputElement||d[i]instanceof HTMLButtonElement||d[i]instanceof HTMLTextAreaElement||d[i]instanceof HTMLSelectElement){d[i].value=e;d[i].bjs_model=this}else d[i].textContent=e}}};bjs.Model.eventHander=a=>{if(!(a.target instanceof HTMLInputElement)&&!(a.target instanceof HTMLButtonElement)&&!(a.target instanceof HTMLTextAreaElement)&&!(a.target instanceof HTMLSelectElement))return;let b=a.target.bjs_model,c=a.target.getAttribute('data-model');if(b===void 0||c===null)return;let d=b.get(c),e=a.target.value;if(d===e)return;b.set(c,e)};bjs.App=class App extends bjs.Model{constructor(a,b){return super(a,b)}};bjs.Fetch=class Fetch{constructor(a){}static http(a){let b='/',c={},d='text';if(typeof a=='string')b=a;if(typeof a=='object'){if(a.url!==void 0)b=a.url;if(a.type!==void 0)d=a.type}return fetch(b,c).then(e=>{switch(d){case'json':return e.json();case'form':return e.formData();default:return e.text();}})}static getJson(a,b){return fetch(a,b).then(response=>response.json())}};bjs.Selector=class Selector extends Array{constructor(a,b){super();if(a!==void 0){switch(a.constructor.name){case'String':if(a.length>0)bjs.Selector.prototype.push.apply(this,document.querySelectorAll(a));break;case'Array':bjs.Selector.prototype.push.apply(this,a);break;default:if(a instanceof HTMLElement)this.push(a);}}this.selector=b}addClass(a){return this._class('add',a)}attr(a,b){return this._forEach({action:'attr',name:a,value:b})}end(){return this.selector}find(a){return this._forEach({action:'find',selector:a})}get(a){return this[a]}hasClass(a,b){return this._forEach({action:'hasClass',class:a,all:b})}html(a){return this._forEach({action:'html',value:a})}is(a,b){return this._forEach({action:'is',selector:a,all:b})}parent(){return this._forEach({action:'parent'})}removeClass(a){return this._class('remove',a)}text(a){return this._forEach({action:'text',value:a})}toggleClass(a,b){return this._class('toggle',a)}val(a){return this._forEach({action:'val',value:a})}_class(a,b,c){if(typeof b=='string')b=b.split(' ');for(let i=0;i<this.length;i++){for(let j=0;j<b.length;j++){if(a==='toggle'){this[i].classList.toggle(b[j],c)}else{this[i].classList[a](b[j])}}}return this}_forEach(a){if(a.value!==void 0){for(let i=0;i<this.length;i++){switch(a.action){case'attr':this[i].setAttribute(a.name,a.value);break;case'html':this[i].innerHTML=a.value;break;case'text':this[i].textContent=a.value;break;case'val':if(this[i]instanceof HTMLInputElement)this[i].value=a.value;break;}}return this}if(this.length===0)return void 0;let b=[],c;for(let i=0;i<this.length;i++){switch(a.action){case'attr':c=this[i].getAttribute(a.name);b.push(c!==null?c:void 0);break;case'find':c=this[i].querySelectorAll(a.selector);for(let i=0;i<c.length;i++)b.push(c[i]);break;case'html':b.push(this[i].innerHTML);break;case'hasClass':c=this[i].classList.contains(a.class);if(a.all!==!0){if(c)return!0}else{if(!c)return!1}break;case'is':c=this[i].matches(a.selector);if(a.all!==!0){if(c)return!0}else{if(!c)return!1}break;case'parent':b.push(this[i].parentNode);break;case'text':b.push(this[i].textContent);break;case'val':b.push(this[i]instanceof HTMLInputElement?this[i].value:void 0);break;}}switch(a.action){case'find':case'parent':return new bjs.Selector(b,this);case'hasClass':case'is':return a.all===!0?!0:!1;default:return b.length>1?b:b[0];}}};