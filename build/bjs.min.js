Object.defineProperty(Object.prototype,'getProperty',{value:function(a){let c=this,d=a.split('.'),e=d.length;for(let i=0;i<e;i++){if(c[d[i]]!==void 0)c=c[d[i]];else return void 0}return c}});Object.defineProperty(Object.prototype,'setProperty',{value:function(a,c){let d=this,e=a.split('.'),f=e.length;for(let i=0;i<f-1;i++){if(d[e[i]]===void 0)d[e[i]]={};d=d[e[i]]}d[e[f-1]]=c}});'use strict';var bjs=selector=>new bjs.Selector(selector);bjs.models=[];bjs.__proto__.getModel=function(a){for(let i in this.models){if(this.models[i].selector.contains(a))return this.models[i]}};bjs.__proto__.observe=a=>{let c,d,e,i,j;for(i in a){c=a[i];for(j=0;j<c.removedNodes.length;j++){d=c.removedNodes[j];e=d._b_model||bjs.getModel(d);if(e)e._unlink(d)}}};if(typeof b=='undefined')var b=bjs;if(typeof $=='undefined')var $=bjs;var observer=new MutationObserver(bjs.observe);observer.observe(document,{attributes:!0,attributeOldValue:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0});bjs.Model=class Model{constructor(a,c){let d=this;bjs.models.push(this);this.proxyHandler=new bjs.ModelProxyHandler(this);this.data=new Proxy(c||{},this.proxyHandler);this.paths=new WeakMap;this.links={};this.selector=new bjs.Selector(a);this._init()}get(a){return this.data.getProperty(a)}set(a,c){this.data.setProperty(a,c)}_init(){let i,a;for(i in this.selector){a=this.selector.get(i);a.addEventListener('change',bjs.Model.eventHander,!0);a.addEventListener('keyup',bjs.Model.eventHander,!0);this._parse_node(a)}}_apply_attributes(a){if(a._b_attributes===void 0)return;if(a instanceof Text){a.nodeValue=a._b_attributes.eval(this);return}for(let i in a._b_attributes)a.setAttribute(i,a._b_attributes[i].eval(this))}_get_elements(a){let c=new Set;while(a!=''){if(this.links[a]!==void 0)this.links[a].forEach(d=>{c.add(d)});a=a.split('.').slice(0,-1).join('.')}return c}_parse_attributes(a){if(a instanceof Text){if(a.nodeValue.indexOf('{{')!==-1){a._b_attributes=new bjs.Expression(a.nodeValue);let i,e=a._b_attributes.getLinks();for(i in e)this._link(a,e[i]);this._apply_attributes(a)}return}let i,c,d=a.attributes;for(i=0;i<d.length;i++){c=d[i];if(c.value.indexOf('{{')!==-1){if(a._b_attributes===void 0)a._b_attributes={};a._b_attributes[c.name]=new bjs.Expression(c.value);let i,e=a._b_attributes[c.name].getLinks();for(i in e)this._link(a,e[i]);this._apply_attributes(a)}}}_parse_node(a,c){if(c)this._apply_attributes(a,c);else this._parse_attributes(a);if(a instanceof Text)return;if(a.hasAttribute('b-for'))this._parse_for(a,c);if(a.hasAttribute('b-base'))this._parse_base(a,c);let i,d,e=a.childNodes;for(i=0;i<e.length;i++){d=e[i];if(d instanceof Comment||d instanceof HTMLBRElement||d instanceof HTMLScriptElement)continue;this._parse_node(d)}if(a.hasAttribute('b-model'))this._parse_model(a,c)}_parse_for(a,c){let d,e,f,g,h,k;if(a._b_template===void 0){a._b_template=a.children[0];a._b_template.remove()}d=a.getAttribute('b-for');this._link(a,d);f=a.getAttribute('b-as')||'_';e=a.getAttribute('b-key');g=this.data.getProperty(d);for(let i in g){h=g[i][e];if(c&&c!=d&&!c.startsWith(d+'.'+h))continue;k=a.querySelector('[b-base="'+d+'.'+h+'"]');if(!k){k=a._b_template.cloneNode(!0);k._b_for=d+'.'+h;k._b_key=h;k.setAttribute('b-base',k._b_for);this._replace_local(k,f,k._b_for);a.appendChild(k)}if(c)this._parse_base(k,c)}if(c&&c===d){for(let i=0;i<a.children.length;i++){k=a.children[i];e=k._b_key||'';if(g[e]===void 0&&k._b_for!==void 0&&k._b_for===d+'.'+e)k.remove()}}}_parse_base(a,c){let d,e,f,g,k,l,m;d=g=a.getAttribute('b-base');this._link(a,g);f=a.getAttribute('b-key');if(f!==null){this._link(a,f);k=this.get(f);if(k!==void 0&&this.get(g+'.'+k)!==void 0)g+='.'+k;else g=''}g+='.';l=Array.prototype.slice.call(a.querySelectorAll('[b-field]'));if(a.hasAttribute('b-field'))l.push(a);for(let i in l){m=l[i];if(g!=='.'){k=g+m.getAttribute('b-field');if(c&&!k.startsWith(c)&&c!==f)continue;if(m.getAttribute('b-model')!==k)m.setAttribute('b-model',k);if(c)this._parse_model(m,c)}else{m.removeAttribute('b-model');this._parse_model(m,c)}}}_parse_model(a){let c='',d=a.getAttribute('b-model');if(d!==null){c=this.data.getProperty(d);if(c===void 0)c='';this._link(a,d)}else this._unlink(a);if(a instanceof HTMLInputElement||a instanceof HTMLButtonElement||a instanceof HTMLTextAreaElement||a instanceof HTMLSelectElement){if(typeof c!='object'&&a.value!=c)a.value=c}else{c=typeof c!='object'?c.toString():JSON.stringify(c);if(a.textContent!=c)a.textContent=c}}_link(a,c){if(this.links[c]===void 0)this.links[c]=new Set;this.links[c].add(a);if(a._b_links===void 0)a._b_links=new Set;a._b_links.add(c);if(a._b_model!==this)a._b_model=this}_unlink(a,c){if(a._b_model!==void 0&&c===void 0){if(a._b_links!==void 0)a._b_links.forEach(d=>{a._b_model._unlink(a,d)})}else{if(this.links[c]!==void 0){this.links[c].delete(a);if(this.links[c].size===0)delete this.links[c]}if(a._b_links!==void 0){a._b_links.delete(c);if(a._b_links.size===0){delete a._b_model}}}}_replace_local(a,c,d){let e=new RegExp('({{.*?)'+c.replace('.','.'),'gim');if(a instanceof Text){if(a.nodeValue.match(e))a.nodeValue=a.nodeValue.replace(e,'$1'+d);return}let i,f,g,h,k=a.attributes;for(i=0;i<k.length;i++){h=k[i];if(h.value.match(e))a.setAttribute(h.name,h.value.replace(e,'$1'+d))}f=a.childNodes;for(i=0;i<f.length;i++){g=f[i];if(g instanceof Comment||g instanceof HTMLBRElement||g instanceof HTMLScriptElement)continue;this._replace_local(g,c,d)}}};bjs.Model.eventHander=a=>{if(!(a.target instanceof HTMLInputElement)&&!(a.target instanceof HTMLButtonElement)&&!(a.target instanceof HTMLTextAreaElement)&&!(a.target instanceof HTMLSelectElement))return;let c=a.target._b_model,d=a.target.getAttribute('b-model');if(c===void 0||d===null)return;let e=c.get(d),f=a.target.value;if(e===f)return;c.set(d,f)};bjs.App=class App extends bjs.Model{constructor(a,c){return super(a,c)}};bjs.ModelProxyHandler=class ModelProxyHandler{constructor(a){this.model=a}get(a,c){if(c==='constructor')return{name:'Proxy'};if(a[c]===void 0){if(c==='length')return Object.keys(a).length;return}if(a[c]!==null&&a[c].constructor.name!=='Proxy'&&typeof a[c]=='object'){let d=this.model.paths.get(a);d=(d!==void 0?d+'.':'')+c;this.model.paths.set(a[c],d);a[c]=new Proxy(a[c],this.model.proxyHandler)}return a[c]}set(a,c,d,e){let f=a[c];a[c]=d;if(f!==d){let g=this.model.paths.get(a);g=(g!==void 0?g+'.':'')+c;let h=this.model._get_elements(g),k=this.model;h.forEach(l=>{k._parse_node(l,g)})}return!0}deleteProperty(a,c){delete a[c];let d=this.model.paths.get(a);d=(d!==void 0?d+'.':'')+c;let e=this.model._get_elements(d),f=this.model;e.forEach(g=>{if(g._b_for!==void 0&&g._b_for===d){f._unlink(g,d);g.remove();return}f._parse_node(g,d)});return!0}};bjs.Selector=class Selector extends Array{constructor(a,c){super();if(a!==void 0){switch(a.constructor.name){case'String':if(a.length>0)bjs.Selector.prototype.push.apply(this,document.querySelectorAll(a));break;case'Array':bjs.Selector.prototype.push.apply(this,a);break;default:if(a instanceof HTMLElement)this.push(a);}}Object.defineProperty(this,'selector',{enumerable:!1,writable:!0});this.selector=c}addClass(a){return this._class('add',a)}attr(a,c){return this._forEach({action:'attr',name:a,value:c})}contains(a){return this._forEach({action:'contains',node:a})}end(){return this.selector}find(a){return this._forEach({action:'find',selector:a})}get(a){return this[a]}hasClass(a,c){return this._forEach({action:'hasClass',class:a,all:c})}html(a){return this._forEach({action:'html',value:a})}is(a,c){return this._forEach({action:'is',selector:a,all:c})}parent(){return this._forEach({action:'parent'})}removeClass(a){return this._class('remove',a)}text(a){return this._forEach({action:'text',value:a})}toggleClass(a,c){return this._class('toggle',a)}val(a){return this._forEach({action:'val',value:a})}_class(a,c,d){if(typeof c=='string')c=c.split(' ');for(let i in this){for(let j in c){if(a==='toggle'){this[i].classList.toggle(c[j],d)}else{this[i].classList[a](c[j])}}}return this}_forEach(a){if(a.value!==void 0){for(let i in this){switch(a.action){case'attr':this[i].setAttribute(a.name,a.value);break;case'html':this[i].innerHTML=a.value;break;case'text':this[i].textContent=a.value;break;case'val':if(this[i]instanceof HTMLInputElement)this[i].value=a.value;break;}}return this}if(this.length===0)return void 0;let i,c,d=[];for(i in this){switch(a.action){case'attr':c=this[i].getAttribute(a.name);d.push(c!==null?c:void 0);break;case'contains':if(this[i]===a.node||this[i].contains(a.node))return!0;break;case'find':Array.prototype.push.apply(d,this[i].querySelectorAll(a.selector));break;case'html':d.push(this[i].innerHTML);break;case'hasClass':c=this[i].classList.contains(a.class);if(a.all!==!0){if(c)return!0}else{if(!c)return!1}break;case'is':c=this[i].matches(a.selector);if(a.all!==!0){if(c)return!0}else{if(!c)return!1}break;case'parent':d.push(this[i].parentNode);break;case'text':d.push(this[i].textContent);break;case'val':d.push(this[i]instanceof HTMLInputElement?this[i].value:void 0);break;}}switch(a.action){case'contains':return!1;case'find':case'parent':return new bjs.Selector(d,this);case'hasClass':case'is':return a.all===!0?!0:!1;default:return d.length>1?d:d[0];}}};