Object.defineProperty(Object.prototype,'getProperty',{value:function(a){let c=this,d=a.split('.'),e=d.length;for(let i=0;i<e;i++){if(c[d[i]]!==void 0)c=c[d[i]];else return void 0}return c}});Object.defineProperty(Object.prototype,'setProperty',{value:function(a,c){let d=this,e=a.split('.'),f=e.length;for(let i=0;i<f-1;i++){if(d[e[i]]===void 0)d[e[i]]={};d=d[e[i]]}d[e[f-1]]=c}});'use strict';var bjs=selector=>new bjs.Selector(selector);bjs.__proto__.get=()=>'get';if(typeof b=='undefined')var b=bjs;if(typeof $=='undefined')var $=bjs;var observer=new MutationObserver(a=>{a.forEach(c=>{let d;for(let i=0;i<c.removedNodes.length;i++){d=c.removedNodes[i];if(d.constructor.name==='Text')continue;if(d._b_model!==void 0)d._b_model._unlink(d);d=d.querySelectorAll('[b-linked]');for(let j=0;j<d.length;j++){if(d[j]._b_model!==void 0)d[j]._b_model._unlink(d[j])}}})});observer.observe(document,{attributes:!0,attributeOldValue:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0});bjs.Model=class Model{constructor(a,c){let d=this;this.proxyHandler={get:(e,f)=>{if(f==='constructor')return{name:'Proxy'};if(e[f]===void 0){if(f==='length')return Object.keys(e).length;return}if(e[f]!==null&&e[f].constructor.name!=='Proxy'&&typeof e[f]=='object'){let g=d.paths.get(e);g=(g!==void 0?g+'.':'')+f;d.paths.set(e[f],g);e[f]=new Proxy(e[f],d.proxyHandler)}return e[f]},set:(e,f,g,h)=>{let k=e[f];e[f]=g;if(k!==g){let l=d.paths.get(e);l=(l!==void 0?l+'.':'')+f;let m=d._get_elements(l);m.forEach(n=>{d._parse(n,l)})}return!0},deleteProperty:(e,f)=>{delete e[f];let g=d.paths.get(e);g=(g!==void 0?g+'.':'')+f;let h=d._get_elements(g);h.forEach(k=>{if(k._b_for!==void 0&&k._b_for===g){d._unlink(k,g);k.remove();return}d._parse(k,g)});return!0}};this.data=new Proxy(c||{},this.proxyHandler);this.paths=new WeakMap;this.links={};this.selector=new bjs.Selector(a);this._init();this._parse()}get(a){return this.data.getProperty(a)}set(a,c){this.data.setProperty(a,c)}_init(){let a;for(let i in this.selector){a=this.selector.get(i);a.addEventListener('change',bjs.Model.eventHander,!0);a.addEventListener('keyup',bjs.Model.eventHander,!0)}}_get_elements(a){let c=new Set;while(a!=''){if(this.links[a]!==void 0)this.links[a].forEach(d=>{c.add(d)});a=a.split('.').slice(0,-1).join('.')}return c}_parse(a,c){if(a!==void 0){if(a.hasAttribute('b-for'))this._parse_for(a,c);if(a.hasAttribute('b-base'))this._parse_base(a,c);if(a.hasAttribute('b-model'))this._parse_model(a)}else{let d,e;d='[b-for][b-key]';e=this.selector.find(d);for(let i in e)this._parse_for(e[i]);d='[b-base], [b-base][b-key], [b-base][b-value]';e=this.selector.find(d);for(let i in e)this._parse_base(e[i]);d='[b-model]';e=this.selector.find(d);for(let i in e)this._parse_model(e[i])}}_parse_for(a,c){let d,e,f,g,h;if(a._b_template===void 0){a._b_template=a.children[0];a._b_template.remove()}d=a.getAttribute('b-for');this._link(a,d);e=a.getAttribute('b-key');f=this.data.getProperty(d);for(let i in f){g=f[i][e];if(c&&c!=d&&!c.startsWith(d+'.'+g))continue;h=a.querySelector('[b-key="'+g+'"]');if(!h){h=a._b_template.cloneNode(!0);h.setAttribute('b-base',d);h.setAttribute('b-key',g);h._b_for=d+'.'+g;a.appendChild(h)}if(c)this._parse_base(h,c)}if(c&&c===d){for(let i=0;i<a.children.length;i++){h=a.children[i];e=h.getAttribute('b-key');if(f[e]===void 0&&h._b_for!==void 0&&h._b_for===d+'.'+e)h.remove()}}}_parse_base(a,c){let d,e,f,g,k,l,m;d=g=a.getAttribute('b-base');this._link(a,g);e=a.getAttribute('b-key');if(e!==null){g+='.'+e;this._link(a,g);if(this.get(g)===void 0)g=''}f=a.getAttribute('b-value');if(f!==null){this._link(a,f);k=this.get(f);if(k!==void 0&&this.get(g+'.'+k)!==void 0)g+='.'+k;else g=''}g+='.';l=Array.prototype.slice.call(a.querySelectorAll('[b-field]'));if(a.hasAttribute('b-field'))l.push(a);for(let i in l){m=l[i];if(g!=='.'){k=g+m.getAttribute('b-field');if(c&&!k.startsWith(c)&&c!==f)continue;if(m.getAttribute('b-model')!==k)m.setAttribute('b-model',k);if(c)this._parse_model(m,c)}else{m.removeAttribute('b-model');this._parse_model(m,c)}}}_parse_model(a){let c='',d=a.getAttribute('b-model');if(d!==null){c=this.data.getProperty(d);if(c===void 0)c='';this._link(a,d)}else this._unlink(a);if(a instanceof HTMLInputElement||a instanceof HTMLButtonElement||a instanceof HTMLTextAreaElement||a instanceof HTMLSelectElement){if(typeof c!='object'&&a.value!=c)a.value=c}else{c=typeof c!='object'?c.toString():JSON.stringify(c);if(a.textContent!=c)a.textContent=c}}_link(a,c){if(this.links[c]===void 0)this.links[c]=new Set;this.links[c].add(a);if(a._b_links===void 0)a._b_links=new Set;a._b_links.add(c);if(!a.hasAttribute('b-linked'))a.setAttribute('b-linked','');if(a._b_model!=this)a._b_model=this}_unlink(a,c){if(a._b_model!==void 0&&c===void 0){if(a._b_links!==void 0)a._b_links.forEach(d=>{a._b_model._unlink(a,d)})}else{if(this.links[c]!==void 0){this.links[c].delete(a);if(this.links[c].size===0)delete this.links[c]}if(a._b_links!==void 0){a._b_links.delete(c);if(a._b_links.size===0){a.removeAttribute('b-linked');delete a._b_model}}}}};bjs.Model.eventHander=a=>{if(!(a.target instanceof HTMLInputElement)&&!(a.target instanceof HTMLButtonElement)&&!(a.target instanceof HTMLTextAreaElement)&&!(a.target instanceof HTMLSelectElement))return;let c=a.target._b_model,d=a.target.getAttribute('b-model');if(c===void 0||d===null)return;let e=c.get(d),f=a.target.value;if(e===f)return;c.set(d,f)};bjs.App=class App extends bjs.Model{constructor(a,c){return super(a,c)}};bjs.Fetch=class Fetch{constructor(a){}static http(a){let c='/',d={},e='text';if(typeof a=='string')c=a;if(typeof a=='object'){if(a.url!==void 0)c=a.url;if(a.type!==void 0)e=a.type}return fetch(c,d).then(f=>{switch(e){case'json':return f.json();case'form':return f.formData();default:return f.text();}})}static getJson(a,c){return fetch(a,c).then(response=>response.json())}};bjs.Selector=class Selector extends Array{constructor(a,c){super();if(a!==void 0){switch(a.constructor.name){case'String':if(a.length>0)bjs.Selector.prototype.push.apply(this,document.querySelectorAll(a));break;case'Array':bjs.Selector.prototype.push.apply(this,a);break;default:if(a instanceof HTMLElement)this.push(a);}}Object.defineProperty(this,'selector',{enumerable:!1,writable:!0});this.selector=c}addClass(a){return this._class('add',a)}attr(a,c){return this._forEach({action:'attr',name:a,value:c})}end(){return this.selector}find(a){return this._forEach({action:'find',selector:a})}get(a){return this[a]}hasClass(a,c){return this._forEach({action:'hasClass',class:a,all:c})}html(a){return this._forEach({action:'html',value:a})}is(a,c){return this._forEach({action:'is',selector:a,all:c})}parent(){return this._forEach({action:'parent'})}removeClass(a){return this._class('remove',a)}text(a){return this._forEach({action:'text',value:a})}toggleClass(a,c){return this._class('toggle',a)}val(a){return this._forEach({action:'val',value:a})}_class(a,c,d){if(typeof c=='string')c=c.split(' ');for(let i in this){for(let j in c){if(a==='toggle'){this[i].classList.toggle(c[j],d)}else{this[i].classList[a](c[j])}}}return this}_forEach(a){if(a.value!==void 0){for(let i in this){switch(a.action){case'attr':this[i].setAttribute(a.name,a.value);break;case'html':this[i].innerHTML=a.value;break;case'text':this[i].textContent=a.value;break;case'val':if(this[i]instanceof HTMLInputElement)this[i].value=a.value;break;}}return this}if(this.length===0)return void 0;let c=[],d;for(let i in this){switch(a.action){case'attr':d=this[i].getAttribute(a.name);c.push(d!==null?d:void 0);break;case'find':Array.prototype.push.apply(c,this[i].querySelectorAll(a.selector));break;case'html':c.push(this[i].innerHTML);break;case'hasClass':d=this[i].classList.contains(a.class);if(a.all!==!0){if(d)return!0}else{if(!d)return!1}break;case'is':d=this[i].matches(a.selector);if(a.all!==!0){if(d)return!0}else{if(!d)return!1}break;case'parent':c.push(this[i].parentNode);break;case'text':c.push(this[i].textContent);break;case'val':c.push(this[i]instanceof HTMLInputElement?this[i].value:void 0);break;}}switch(a.action){case'find':case'parent':return new bjs.Selector(c,this);case'hasClass':case'is':return a.all===!0?!0:!1;default:return c.length>1?c:c[0];}}};